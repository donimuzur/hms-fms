<section class="content-header">
    <h1>
        Fleet Accident Form
    </h1>
</section>
<section class="content" ng-init="CAFCtrl.init()">
    <div class="row">
        <form role="form" ng-repeat="caf in CAFCtrl.caf">
            <div class="col-md-12 ">
                <div class="box-tools pull-right" style="margin-top:-50px">
                    <h4>
                        <label for="" class="control-label">Status:</label>
                        <label class="control-label">{{caf.status1}}</label>
                    </h4>
                </div>
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">User</h3>
                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
                                <i class="fa fa-minus"></i>
                            </button>
                        </div>
                    </div>
                    <!-- form start -->
                    <div class="box-body">
                        <div class="col-md-6">
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">SIRS No.</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.SIRS_number}}" readonly="">
                                </div>
                            </div>
                            <div ng-init="CAFCtrl.getCoord(caf.coordinator)">
                                <div class="col-md-4">
                                    <label for="" class="control-label">Coordinator</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{CAFCtrl.coord}}" disabled>
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">Police Number</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.police_number}}" disabled>
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">Employee Name</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.employee_name}}" readonly="">
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label for="Vtype" class="control-label">Supervisor</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.supervisor}}" readonly="">
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">Area</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.location}}" readonly="">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">Vehicle Model</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.model}}" readonly="">
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">Vendor</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.vendor_name}}" readonly="">
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">Incident Date</label>
                                </div>
                                <div class="col-md-8" ng-init="">
                                    <div class="input-group" style="background-color: #ffffff;padding-bottom: 11px;">
                                        <input readonly class="form-control" size="16" type="text" value="{{CAFCtrl.dateFormat(caf.incident_date)}}" disabled />
                                        <span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label for="" class="control-label">Location</label>
                                </div>
                                <div class="col-md-8">
                                    <input type="text" class="form-control" value="{{caf.incident_location}}" readonly="">
                                </div>
                            </div>
                            <div>
                                <div class="col-md-4">
                                    <label class="control-label">Incident Description</label>
                                </div>
                                <div class="col-md-8">
                                    <textarea class="form-control" readonly="" style="height: 95px;overflow-y: scroll;">{{caf.incident_description}}
                                    </textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /.box-body -->
                    <!-- /.box-footer -->
                </div>
            </div>
            <div class="col-md-12 ">
                <!-- general form elements -->
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">Fleet Management Section</h3>
                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
                                <i class="fa fa-minus"></i>
                            </button>
                        </div>
                    </div>
                    <!-- /.box-header -->
                    <!-- form start -->
                    <div class="box-body">
                        <table id="example1" class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th style="text-align: center;">Progress Update</th>
                                    <th style="text-align: center;">Progress Date</th>
                                    <th style="text-align: center;">Remark</th>
                                    <th style="text-align: center;">Estimation</th>
                                    <th style="text-align: center;">Actual</th>
                                </tr>
                            </thead>
                            <tbody style="overflow-x:auto">
                                <tr ng-repeat="progres in CAFCtrl.cafProgress">
                                    <td>{{progres.status1}}</td>
                                    <td style="text-align:center">{{CAFCtrl.dateFormat(progres.progress_date)}}</td>
                                    <td>{{progres.remark}}</td>
                                    <td style="text-align:center">{{progres.estimation}}</td>
                                    <td style="text-align:center">{{progres.actual}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="box-tools pull-right" style="margin-bottom: 20px; margin-right: 20px">
                <button class="btn bg-blue" style="margin-top:5px;" ng-click="CAFCtrl.cancel(caf.accident_id)" ng-show="caf.caf_status_id!=11&&coordinator==TemporaryCtrl.coordinatorID">
                    <i class="glyphicon glyphicon-ban-circle"></i> Cancel
                </button>
            </div>
        </form>
        <div class="col-md-12">
            <div class="box" style="margin-bottom:0px">
                <div class="box-header with-border">
                    <h3 class="box-title">Change Log</h3>
                </div>
                <div class="box-body" ng-repeat="caf in CAFCtrl.caf" ng-init="CAFCtrl.getLog(caf.accident_id)">
                    <div style="overflow-y:scroll; max-height:150px; ">
                        <table id=" log" class="table table-bordered table-hover" style="table-layout:fixed;">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Role</th>
                                    <th>Action</th>
                                    <th>Date</th>
                                    <th>Remark</th>
                                </tr>
                            </thead>
                            <tbody ng-repeat="log in CAFCtrl.log">
                                <tr>
                                    <td>{{log.user_name}}</td>
                                    <td>{{log.role.substr(12)}}</td>
                                    <td>{{log.status}}</td>
                                    <td>{{CAFCtrl.dateFormatLog(log.log_date)}}</td>
                                    <td>{{log.remark1}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.row -->

</section>
<script type="text/ng-template" id="remark.html">
    <div class="modal-header">
        <h3 class="modal-title" id="modal-title">Cancel Remark</h3>
    </div>
    <div class="modal-body" id="modal-body">
        <div class="col-md-12">
            <div class="box" style="overflow-y:auto;">
                <div class="box-body">
                    <div class="col-md-4">
                        <label>Remark</label>
                    </div>
                    <div class="col-md-8">
                        <div class="form-group " ng-init="getRemark()">
                            <select class="form-control" ng-model="remark" required>
                                <option ng-repeat="remark in dataRemark" value="{{remark.remark_id}}">{{remark.remark1}}</option>
                            </select>
                            <span class="form-control-feedback "></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" ng-click="batal()" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" ng-click="simpan()" class="btn btn-primary">Save</button>
    </div>
</script>